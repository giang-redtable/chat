<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Chat</title>
<link rel="stylesheet" type="text/css" href="./semantic/dist/semantic.min.css">

<style>
.name{ width: 10%; }
.message{ width: 90%; }
.chat{ width: 10%; }
</style>

</head>
<body>
<div class="container">
	<div class="ui fixed red borderless inverted menu" style="border-radius: 0px; margin: 0px;"><h4 class="header item">REDTABLE CHATBOT v0.1</h4></div>
	<!-- Chat log -->
    <div style="overflow-x: hidden; overflow-y: auto;padding:40px 15px 40px 15px;" id="chatLog" class="ui comments" readonly>
		<div class="ui icon small message">
		  <i class="comments outline icon"></i>
		  <div class="content">
			<div class="header">
			  REDTABLE chatbot v0.1
			</div>
			<p>Get the best recommendation menu.</p>
		  </div>
		</div>		
    </div>
	<!-- Chat log -->

	<!-- Message box -->

	<form id="chat">	
	<input id="name" class="name" type="hidden" readonly>	
	<input id="channel" type="hidden" value=""/>	
	

	<div class="ui fixed bottom borderless sticky action input">
		<input type="text" id="message" name="message">
		<button id="chat" class="ui red right borderless submit button">Send</button>	
	</div>
	
    </form>

	<!-- Message box -->

    <script src="/socket.io/socket.io.js"></script>
	<script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>

    <script>
      var socket = io();      
      var dateN = Date.now();

      socket.emit('join:channel', { channelId: dateN });      
      $('#channel').val(dateN);	 

      $('#chat').on('submit', function(e){
        socket.emit('send message', { userName: $('#name').val(), msg: $('#message').val(), channelId: $('#channel').val() });
        $('#message').val("");
        $("#message").focus();
        e.preventDefault();
      });

      socket.on('receive message', function(msg){
        $('#chatLog').append(msg+'<br>');
        $(document).scrollTop($('#chatLog')[0].scrollHeight);
      });

      socket.on('change name', function(name){
        $('#name').val(name);
      });
	
    </script>
	
	<script src="./semantic/dist/semantic.min.js"></script>
</div>
</body>
</html>